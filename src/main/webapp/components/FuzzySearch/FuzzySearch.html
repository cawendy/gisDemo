<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QueryLocationInfo</title>
    <link rel="stylesheet" href="../../thirdLib/arcgis_js_api/library/3.21/3.21/esri/css/esri.css">
    <link rel="stylesheet" href="../../thirdLib//arcgis_js_api/library/3.21/3.21/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="./css/Style.css">
    <style>
        html, body, #map {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            background-color: #FFF;
            overflow: hidden;
            font-family: "Trebuchet MS";
        }
        #toolbar {
            position: relative;
            width: 100%;
            height: 50px;
            background-color: white;
            box-shadow: inset 0px -2px 0px #ddd;
        }
    </style>
    <script src="../../js/config/dojoconfig.js"></script>
    <script src="../../thirdLib/arcgis_js_api/library/3.21/3.21/init.js"></script>
    <script>
        var map;
        require(["esri/map",
                "esri/layers/ArcGISTiledMapServiceLayer",
                "components/FuzzySearch/FuzzySearch",
                "esri/tasks/QueryTask",
                "esri/tasks/query",
                "esri/geometry/Point",
                "esri/SpatialReference",
                "dojo/on",
                "dojo/topic",
                "dojo/_base/lang",
                "dojo/domReady!"],
            function(Map, ArcGISTiledMapServiceLayer,FuzzySearch,QueryTask,Query,Point,SpatialReference,on,topic,lang) {

                map = new Map("map", {
                    basemap: "topo",
                    center: [100, 36],
                    zoom:13
                });

                //var tiled = new ArcGISTiledMapServiceLayer("http://99.12.100.11:6080/arcgis/rest/services/basemap/MapServer");
                //map.addLayer(tiled);


                on(map, "load",lang.hitch(this,function () {
                    //topic.publish("mapLoaded");
                    var  url = "http://99.12.88.47:6080/arcgis/rest/services/crm/crmbranch/MapServer/0";
                    var searcher = new FuzzySearch({
                        "map":this.map,
                        "serviceUrl":url,
                        "container":dojo.byId("toolbar")
                    });
                    searcher.startup();
                    alert("构造数据即可用");
                }));

            }
        );
    </script>
</head>
<body class="claro">
<div id="toolbar" >
</div>
<div id="map"></div>

</body>
</html>